#!/usr/bin/env python
# encoding: utf-8

import sys
import os
import csv
import string

def main():
	d = 8

	width = 600
	rowHeight = 50
	rowSpacer = 5

	labels = { }
	timevals = { }
	startTime = -1
	endTime = -1
	totalTime = 0

	possibleColors = []
	myColorMap = {}
	skipTypes
	
	for di in range(0,d):
		with open(str(di)+'.0', 'rb') as tf:
			labels[di] = []
			timevals[di] = []
			for line in tf:
				pieces = line.split(':')
				labels[di].append(pieces[0].strip())
				timevals[di].append(int(pieces[1].strip()))
		if startTime < 0 or startTime > timevals[di][0]:
			startTime = timeVals[di][0]
		if endTime < 0 or endTime < timevals[di][len(timevals[di])-1]:
			startTime = timeVals[di][0]

	totalTime = endTime - startTime


	# print out latex/tikz preamble here

	for di in range(0,d):
		dlablel = labels[di]
		dtimes = timevals[di]

		rectTop = di * (rowHeight + rowSpacer)
		rectBottom = rectTop + rowHeight

		i = 0
		while True:
			if i-1 > len(dtimes):
				break

			labelkey = dlabel[i].replace('Begin','').replace('End','').strip()
			labelkey2 = dlabel[i+1].replace('Begin','').replace('End','').strip()

			if labelkey == labelkey2 and 'Begin' in dlabel[i] and 'End' in dlabel[i+1]:
				rectStart = 1.0 * (dtimes[i] - startTime)/totalTime * width
				rectEnd =  1.0 * (dtimes[i+1] - startTime)/totalTime * width 

				if labelkey in myColorMap:
					curColor = myColorMap[labelkey]
				else:
					curColor = possibleColors.pop()
					myColorMap[labelkey] = curColor

				# print rectangle with rectTop, rectBottom, rectStart, rectEnd
				# color should be curColor

				# Note this does not do aggregation of adjacent blocks or handle multiple layers of blocks

				i = i + 2
				continue
			else:
				i = i+1
				continue



				
	# print out latex/tikz closing here

if __name__ == '__main__':
	main()




